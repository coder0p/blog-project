{% extends "base.html" %}{% block title %}homepage{% endblock %}

{% block content%}


<!-- Navbar -->

<nav class="navbar navbar-expand-lg fixed-top bg-light navbar-light">
  <div class="container">
    <a class="navbar-brand" href="{{ url_for('views.home') }}"><img id="blog-logo"
        src="https://www.freeiconspng.com/thumbs/blogger-logo-icon-png/blogger-logo-icon-png-28.png" alt="MDB Logo"
        draggable="false" height="30" /></a>
    <button class="navbar-toggler" type="button" data-mdb-toggle="collapse" data-mdb-target="#navbarSupportedContent"
      aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <i class="fas fa-bars"></i>
    </button>

    <!-- Post icon -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ms-auto align-items-center">

        <!-- Checking if user is logged in or not -->
        {% if current_user.is_authenticated %}
        <li class="nav-item">
          <a class="nav-link mx-2" href="{{ url_for('views.create_post') }}"><i
              class="fas fa-plus-circle pe-2 text-success"></i>Post</a>
        </li>

        <!-- User icon and dropdown -->
        <li class="nav-item me-3 me-lg-0 dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-mdb-toggle="dropdown"
            aria-expanded="false">
            <i class="fas fa-user"></i>
          </a>
          <ul class="dropdown-menu dropdown" aria-labelledby="navbarDropdown">
            <li class="dropdown-content">
              <p class="dropdown-item"> Hi.. {{ current_user.username }} !</p>
            </li>
          </ul>
        <li class="nav-item ms-3">
          <a class="btn btn-black btn-rounded" href="{{ url_for('auth.logout') }}">Logout</a>
        </li>

        {% else %}
        <li class="nav-item">
          <a class="nav-link mx-2" href="{{ url_for('auth.login') }}"><i class="fas fa-plus-circle pe-2"></i>Post</a>
        </li>
        <li class="nav-item ms-3">
          <a class="btn btn-black btn-rounded" href="{{ url_for('auth.login') }}">Sign in</a>
        </li>

        {% endif %}

      </ul>
    </div>
  </div>
</nav>


<!-- Displaying created post in home page -->
{% if posts %}
<h1 class="text-center pt-2">
  <mark class="rounded-pill shadow-4">Latest posts</mark>
</h1>
{%for post in posts%}
<div class="container mt-4 shadow-4 position-relative">
  <div class="position-relative">
    <h2 class="text-center">{{post.title}}</h2>
    <span class="small position-absolute top-0 start-0">
      <i class="fas fa-user-circle"></i>
      posted by <strong>{{post.user.username}}</strong>
      <i>{{post.date_created|timesago}}</i></span>
    <span class="badge bg-secondary position-absolute top-0 end-0">
      <i class="fa-solid fa-star star"></i>
      {{post.category}}</span>
    
    
  </div>
  <p>
    {{post.content}}
  </p>
  <br>
    {% if current_user.is_authenticated %}
    {% if current_user.id == post.user_id%}
    <a class="btn btn-danger btn-sm position-absolute bottom-0 end-0"
    href="{{ url_for('views.delete_post', id=post.id) }}">delete</a>
  {% endif %}
  {% endif %}

  <span class="pull-right"><a class="text-danger" 
    href="{{ url_for('views.view_post', id=post.id) }}">view_post</a></span>
</div>
{% endfor %}
{% endif %}

{% endblock %}